<!DOCTYPE html>
<html>
  <head>
    <title>Simple Map</title>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <style>
      html, body, #map-canvas {
        margin: 0;
        padding: 0;
        height: 100%;
      }
    </style>
    <script src="https://maps.googleapis.com/maps/api/js?v=3&key=AIzaSyCDbu78y8JGWwQvJyW3ISJZg0Pe42tFaek&library=geometry"></script>
    <script type="text/javascript" src="qrc:///qtwebchannel/qwebchannel.js"></script>
    <script type="text/javascript" >

google.maps.visualRefresh = true;
var map;
  var geoCoder = null;
  var placesService;
  var channel;
  var lastMessage;

	function initialize()
	{
                if (typeof qt != 'undefined')
                {
                    channel = new QWebChannel(qt.webChannelTransport, function(channel)
                    {
                            //qt.webChannelTransport.onmessage = handleTransportMessage;

                                    console.log("transport   "+qt.webChannelTransport);


                            if (channel.objects.Geocoder != null)
                            {
                                    channel.objects.Geocoder.sendGeocoderRequest.connect(function(request)
                                    {
                                            geocodeStringAddress(request);
                                            console.log("geocoder   "+arguments);
                                            console.log("geocoder   "+arguments.length);
                                            console.log("geocoder   "+arguments[0]);
                                    });

                                    channel.objects.Geocoder.test.connect(function(data)
                                    {
                                            console.log("test   "+data);
                                            geocodeStringAddress(data);
                                            console.log("test num args   "+arguments.length);
                                            console.log("test 1st arg   "+arguments[0]);
                                    });

                                    console.log("transport   "+qt.webChannelTransport);
                                    window.geocoder = channel.objects.Geocoder;
                                    console.log("geocoder   "+window.geocoder);
                            }
                            else
                            {
                                console.log("channel.objects.Geocoder   "+channel.objects.Geocoder);
                                    qt.webChannelTransport.send2();
                            }

                    });
                }
                console.log("initialize   "+channel);
            var mapOptions =
            {
                    zoom: 8,
                    scaleControl: true,
                    scaleControlOptions:
                    {
                        position: google.maps.ControlPosition.BOTTOM_CENTER
                    },
                    center: new google.maps.LatLng(30.267, -97),
                    mapTypeId: google.maps.MapTypeId.ROADMAP
             };
            map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);
	  
            google.maps.event.addListener(map, 'click', placeMarker);
            google.maps.event.addListener(map, 'zoom_changed', handleZoomChange);
    }
	
	function handleTransportMessage(message)
	{
		console.log("Message received  "+ message);
                lastMessage = message;
	}

    

    document.addEventListener("DOMContentLoaded", function ()
    {

        console.log("initialize doc loader  "+window.geocoder);
    });

    google.maps.event.addDomListener(window, 'load', initialize);
  
  <!-- Can call this from AIR using the DOM for geocoding stuff..weeeeee -->
  function geocodeStringAddress(_stringAddress) {
	  console.log("looking up geocode address "+_stringAddress)
	if(geoCoder == null) {
		geoCoder = new google.maps.Geocoder();
	}
	geoCoder.geocode( { 'address': _stringAddress}, handleGeocodeResult );
  }
  
    <!-- Handles the result of a geocode -->
  function handleGeocodeResult(results, status) 
	{
		
		if (status == google.maps.GeocoderStatus.OK) 
		{
		
			try {
				console.log("  results are back  "+ results)
				console.log("  num results  "+ results.length)
				console.log("  num results  "+ results[0].geometry.location.lat()+ " : "+ results[0].geometry.location.lng())
				var position = new google.maps.LatLng(results[0].geometry.location.lat(), results[0].geometry.location.lng())
				map.setCenter(position);
				map.setZoom(14);
				// This calls flash with the resuls check your traces
                                window.geocoder.setRequestResults(results, status);
                                //channel.objects.Geocoder.setRequestResults(results, status);
				// Call this so we get a map going
				//initialize( results[0].geometry.location );
			} catch (err) {
				// Sink the error that was trying to call an AIR function
			}
		} 
		else 
		{
			try {
				// Calls a function in AS3 that references the error
				window.JSgeocodeError(status);
			} catch (err) {
				// Sink it
			}
		}
	}
  
	function centerOnLocation(position)
	{
		map.panTo(position);
	}
  
	function computeDistanceBetween(LatLng1, LatLng2)
	{
	  
	}
  
	function computeLength(list)
	{
  
	}
	
	function computeArea(list)
	{
  
	}
  
	function placeMarker(event)
	{
		var newMarker = new google.maps.Marker({position:event.latLng, map:map});
	}
  
	function handleZoomChange(event)
	{
	  
	}
	  
	function handleMarkerClicked(event)
	{
	  
	}
  
	function lockBounds()
	{
  
	}
  
    function unlockBounds()
	{
  
	}
	
	function loadjsfile(filename)
	{
		
		//load an external JavaScript file
		var fileref=document.createElement('script')
		fileref.setAttribute("type","text/javascript")
		fileref.setAttribute("src", filename)	
		if (typeof fileref!="undefined")
		{
			document.getElementsByTagName("head")[0].appendChild(fileref)
		}
	}
    </script>
  </head>
  <body>
    <div id="map-canvas">
		
	</div>
  </body>
</html>

